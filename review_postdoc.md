# ポスドク向け高度レビュー（P版）: Dimension reduction in quantum sampling of stochastic processes

## P0. 目的と読み方（対応: S0, S1, S12）
- 本稿は学生向け `S版` を前提に、理論導出と境界の意味を研究者向けに補強する。
- 各節冒頭の `対応: S*` で、学生版との往復参照点を明示する。
- 焦点は次の3点。
  1. 証明スケッチで「どの不等式が効いているか」を明確化。
  2. loose bound 化の箇所と、その代償（タイト性喪失）を整理。
  3. 数値最適化（変分切り詰め）の収束・計算量・安定性を実装観点で評価。

## P1. 問題設定の厳密化（対応: S2, S3）
### P1.1 生成モデル
- 離散時間・離散イベント・定常過程を対象。
- 量子生成は
\[
U|\sigma_j\rangle|0\rangle=\sum_x\sqrt{P(x|j)}e^{i\phi_{xj}}|x\rangle|\sigma_{\lambda(x,j)}\rangle
\]
で定義される（論文 Eq.(1)）。

### P1.2 q-sample と iMPS 同型
- q-sample を iMPS へ写像するサイト行列は
\[
A^x_{kj}=\sqrt{P(x|j)}\delta_{\lambda(x,j),k}
\]
（論文 Eq.(3)）。
- 左正準形テンソルが Kraus作用素となる点が、後段の `\tilde U` 合成と直接接続する。

### P1.3 コスト指標の二層構造
- 幾何学的容量: `D_q=\log_2 d`。
- 情報的容量: `C_q=S(\rho)`。
- 圧縮可能性の本質は `C_q/D_q` の乖離にある（単純な `d` の大きさではない）。

## P2. QFDR と統計FDRの接続（対応: S5.3, S6.4, S7.3）
### P2.1 QFDRの役割
- 無限鎖では fidelity 自体がゼロ化しやすいため、速度量としての QFDR を導入。
- `R_F^{-1}` は「fidelity が半減する典型長さ」の指標解釈を持つ。

### P2.2 位相因子と上界性
- 位相なし（厳密な構造条件が満たされる場合）では q-sample 間QFDRと統計FDRが対応。
- 位相あり（圧縮近似で通常発生）では QFDR が統計FDRの上界として機能。
- 実務上は「QFDRを下げる」設計が統計再現性向上の保守的指標になる。

## P3. Theorem 1 の証明スケッチ（対応: S6.1, S8.2）
### P3.1 証明の骨格
1. 有限長MPS近似の重なり境界
\[
|1-\langle\psi_d^L|\psi_{\tilde d}^L\rangle|\le\sum_{l=1}^{L}\epsilon_{\tilde d}^{[l]}
\]
（Methods B, Eq.(23)）。
2. 一様な bond truncation で `\epsilon_{\tilde d}^{[l]}=\epsilon_{\tilde d}` として
\[
\langle\psi_d^L|\psi_{\tilde d}^L\rangle\ge 1-L\epsilon_{\tilde d}
\]
（Eq.(25)）。
3. 混合転送行列 `\tilde E_r` の主固有値 `\mu_0` と QFDR を結び
\[
R_F=-\frac{1}{2}\log_2|\mu_0|
\]
（Eq.(30) 導出部）へ落とす。

### P3.2 どこが効いているか
- 主項は `-\frac{1}{2L}\log_2(1-L\epsilon_{\tilde d})`。
- `\epsilon_{\tilde d}` の線形スケーリングが、低歪み圧縮の理論根拠。

### P3.3 タイト性の注意
- `O(1/L)` 項・高次固有値寄与は有限長評価で効きうる。
- 実験設計では理論上界をそのまま実測値と同一視しない方が安全。

## P4. Theorem 2 / Corollary 1 の証明スケッチ（対応: S6.2, S6.3, S8.3）
### P4.1 確率分布化の戦略
- Schmidt係数列 `\{\lambda_j\}` を確率分布とみなし、majorization と Schur凹性を適用。
- 分布族 `\mathcal P(\tilde d,\epsilon_{\tilde d},h)`（Eq.(31)）で worst-case を抑える。

### P4.2 不等式チェーン
- `h` の上下界（Eq.(33)）を使い、
\[
H(\lambda)\ge \text{(関数 of }\epsilon_{\tilde d},d,\tilde d\text{)}
\]
から
\[
\epsilon_{\tilde d}
\le
\frac{H(\lambda)}{\frac{\tilde d-2}{d-\tilde d}\log_2(d-\tilde d)+\log_2\tilde d}
\]
（Eq.(35)）を得る。

### P4.3 Corollary 1 の loose bound
- `C_q=H(\lambda)` 同一視と分母第1項の非負性のみを残して
\[
\epsilon_{\tilde d}\le\frac{C_q}{\tilde D_q}
\]
へ緩和。
- 利点: 設計指標として単純。
- 代償: `d,\tilde d` 依存の詳細情報を捨てるため境界は緩い。

## P5. Corollary 2 と古典比較の意味（対応: S6.4, S7.3, S8.4）
### P5.1 量子モデルへの移送
- q-sample 側で得た境界を統計FDR境界へ転用できるため、生成状態近似がそのままモデリング近似保証になる。

### P5.2 古典比較の公平性
- Methods D は uniﬁlar古典モデルを直接最適化せず、より広い pre-model で下界を取る。
- したがって「古典最適値の厳密計算」ではなく「古典側に有利な下界比較」に近い解釈が妥当。

### P5.3 解釈上の注意
- 論文の主張は「提示例で有意優位」であり、任意過程での一様優位を証明したものではない。

## P6. 変分切り詰めアルゴリズムの実装論点（対応: S5.4, S9.2）
### P6.1 反復構造
- Eq.(9) の混合転送行列 → 主固有構造抽出 → Eq.(10) 更新 → Eq.(11) 収束判定。
- injectivity を保つ設計が直接切り詰め法より安定という経験的報告。

### P6.2 計算量
- 論文記載の一回あたりスケールは `O(d\tilde d^2|X| + d^2|X|^2)`。
- 大きいアルファベットでは `|X|^2` 項の影響が強く、前処理支配になりうる。

### P6.3 数値安定性と停止条件
- `\Delta` だけでなく `R_F` の実測低下トレンド監視が望ましい。
- 固有値分離が小さい場合、更新の振動や停滞が起きやすい。
- 初期値依存があるため多初期値ランの併用が安全。

### P6.4 ゲート合成の現実コスト
- `\tilde U` 生成後の gate decomposition は別ボトルネック。
- 本手法は「量子メモリ次元」を減らすが、全体実装コストはデバイス制約込みで評価する必要がある。

## P7. 実験結果の研究的読み解き（対応: S7）
### P7.1 cyclic random walk
- 大アルファベットMarkov過程で `C_q` が有限に留まる設定は、`C_q << D_q` 仮説検証に適している。
- 結果は「高次元空間に埋まるが有効自由度は低い」ケースを支持。

### P7.2 Dyson-Ising
- 非Markov性増大 (`L` 増加) 下でも、1qubit級メモリで低歪み達成は強い結果。
- ただし温度領域依存があり、低温・臨界近傍の難化は将来検証余地。

### P7.3 指標間の使い分け
- FDR系は重なりベースで滑らか、KL系はゼロ確率感度が高い。
- 同一結論でも指標依存で「見え方」が変わるため、複数指標併用が妥当。

## P8. 限界、反例可能性、拡張（対応: S9）
### P8.1 限界
- 境界は保守的で、過程によっては圧縮利益が小さい可能性。
- 非injective近傍や長距離相関が強い系での安定性は未整理領域が残る。

### P8.2 反例可能性
- `C_q` が低くても、スペクトル形状や実装制約次第で良い `\tilde d` が見つからない可能性。
- 指標選択（QFDR vs KL率）で性能順位が変わるケースを排除できない。

### P8.3 拡張課題
- データ駆動で直接 `\tilde U` を学習する枠組み。
- 連続時間過程・非定常過程への移植。
- 物理デバイス制約を組み込んだ圧縮最適化（gate set aware）。

## P9. 研究者向けチェックリスト（対応: S11）
- 問題設定で `C_q` と `D_q` の乖離が確認できるか。
- truncation 後の `R_F` 実測が理論境界と矛盾しないか。
- 初期値依存・収束停滞に対するロバスト性評価をしたか。
- 古典比較が同条件（同次元・同指標・同系列長極限）になっているか。
- 実装段階で gate decomposition コストを別途見積もったか。

## P10. 学生版への戻り先（対応: S12）
- 背景確認: `S2`
- 基本概念: `S3-S4`
- 提案手法の最短理解: `S5`
- 定理の意味だけ確認: `S6`
- 結果の要点のみ確認: `S7`
